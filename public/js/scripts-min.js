angular.module("app").controller("mvMainCtrl",["$scope","mvCachedCourses",function(t,e){t.products=e.query()}]),function(){"use strict";angular.module("app").controller("mvNavBarLoginCtrl",["$scope","$http","mvIdentity","mvNotifier","mvAuth","$state",function(t,e,r,n,o,u){t.identity=r,t.signin=function(t,e){o.authenticateUser(t,e).then(function(t){t?(n.notify("You have successfully signed in!"),u.go("productList")):n.error("Username/Password combination incorrect")})},t.signout=function(){o.logoutUser().then(function(){t.username="",t.password="",n.notify("You have successfully signed out!"),u.go("home")})}}])}(),angular.module("app").factory("mvIdentity",["$window","mvUser",function(t,e){var r;return t.bootstrappedUserObject&&(r=new e,angular.extend(r,t.bootstrappedUserObject)),{currentUser:r,isAuthenticated:function(){return!!this.currentUser},isAuthorized:function(t){return!!this.currentUser&&this.currentUser.roles.indexOf(t)>-1}}}]),angular.module("app").value("mvToastr",toastr),angular.module("app").factory("mvNotifier",["mvToastr",function(t){return{notify:function(e){t.success(e),console.log(e)},error:function(e){t.error(e),console.log(e)}}}]),angular.module("app").service("httprequest",["$q","$http",function(t,e){this.http_get=function(r){var n=t.defer();return e.get(r).success(function(t,e,r,o){return n.resolve(t),n.promise}).error(function(t,e,r,n){}),n.promise},this.http_post=function(r,n){var o=t.defer();return e.post(r,n,{headers:{"Content-Type":"application/json"}}).success(function(t,e,r,n){return o.resolve(t),o.promise}).error(function(t,e,r,n){}),o.promise},this.http_delete=function(r){var n=t.defer();return e.delete(r).success(function(t,e,r,o){return n.resolve(t),n.promise}).error(function(t,e,r,n){}),n.promise},this.http_put=function(){var r=t.defer();return e.put(url,requestdata,{headers:{"Content-Type":"application/json"}}).success(function(t,e,n,o){return r.resolve(t),r.promise}).error(function(t,e,r,n){}),r.promise}}]),angular.module("app").factory("mvAuth",["$http","mvIdentity","$q","mvUser",function(t,e,r,n){return{authenticateUser:function(o,u){var i=r.defer();return t.post("/login",{username:o,password:u}).then(function(t){if(t.data.success){var r=new n;angular.extend(r,t.data.user),e.currentUser=r,i.resolve(!0)}else i.resolve(!1)}),i.promise},createUser:function(t){var o=new n(t),u=r.defer();return o.$save().then(function(){e.currentUser=o,u.resolve()},function(t){u.reject(t.data.reason)}),u.promise},updateCurrentUser:function(t){var n=r.defer(),o=angular.copy(e.currentUser);return angular.extend(o,t),o.$update().then(function(){e.currentUser=o,n.resolve()},function(t){n.reject(t.data.reason)}),n.promise},logoutUser:function(){var n=r.defer();return t.post("/logout",{logout:!0}).then(function(){e.currentUser=void 0,n.resolve()}),n.promise},authorizeCurrentUserForRoute:function(t){return e.isAuthorized(t)?!0:r.reject("not authorized")},authorizeAuthenticatedUserForRoute:function(){return e.isAuthenticated()?!0:r.reject("not authorized")}}}]),angular.module("app").factory("mvUser",["$resource",function(t){var e=t("/api/users/:id",{_id:"@id"},{update:{method:"PUT",isArray:!1}});return e.prototype.isAdmin=function(){return this.roles&&this.roles.indexOf("admin")>-1},e}]),angular.module("app").controller("mvUserListCtrl",["$scope","mvUser",function(t,e){t.users=e.query()}]),function(){"use strict";angular.module("app").controller("mvSignupCtrl",["$scope","mvUser","mvNotifier","$location","mvAuth","$state",function(t,e,r,n,o,u){t.signup=function(){var e={username:t.email,password:t.password,firstName:t.fname,lastName:t.lname};o.createUser(e).then(function(){r.notify("User account created!"),u.go("productList")},function(t){r.error(t)})}}])}(),angular.module("app").controller("mvProductDetailCtrl",["$scope","$stateParams","$http","$modal",function(t,e,r,n){var o=function(){r.get("/api/products/"+e.id).then(function(e){t.product=e.data})};o(),t.open=function(e){var r=n.open({templateUrl:"app/products/mvModal.html",controller:"ModalInstanceCtrl",size:e});r.result.then(function(e){t.selected=e},function(){$log.info("Modal dismissed at: "+new Date)})}}]),function(){"use strict";angular.module("app").directive("ngThumb",["$window",function(t){var e={support:!(!t.FileReader||!t.CanvasRenderingContext2D),isFile:function(e){return angular.isObject(e)&&e instanceof t.File},isImage:function(t){var e="|"+t.type.slice(t.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(e)}};return{restrict:"A",template:"<canvas/>",link:function(t,r,n){function o(t){var e=new Image;e.onload=u,e.src=t.target.result}function u(){var t=i.width||this.width/this.height*i.height,e=i.height||this.height/this.width*i.width;a.attr({width:t,height:e}),a[0].getContext("2d").drawImage(this,0,0,t,e)}if(e.support){var i=t.$eval(n.ngThumb);if(e.isFile(i.file)&&e.isImage(i.file)){var a=r.find("canvas"),c=new FileReader;c.onload=o,c.readAsDataURL(i.file)}}}}}])}(),function(){"use strict";function t(t,e,r,n,o){var u=this,i="",a="0"==n.id?"/api/productcreate":"/api/productupdate",c=function(){r.http_get("/api/products/"+n.id).then(function(t){u.product=t,i=u.product.imageUrl,u.product&&u.product.productId&&(u.title="Edit: "+u.product.productName)})};"0"!==n.id?c():u.title="New Product",u.priceOption="percent",u.marginPercent=function(){return e.calculateMarginPercent(u.product.price,u.product.cost)},u.calculatePrice=function(){var t=0;"amount"==u.priceOption&&(t=e.calculatePriceFromMarkupAmount(u.product.cost,u.markupAmount)),"percent"==u.priceOption&&(t=e.calculatePriceFromMarkupPercent(u.product.cost,u.markupPercent)),u.product.price=t},u.open=function(t){t.preventDefault(),t.stopPropagation(),u.opened=!u.opened},u.submit=function(t){t?(u.product.imageUrl=i,console.log(u.product),r.http_post(a,u.product).then(function(t){toastr.success("Save Successful")})):alert("Please correct the validation errors first.")},u.cancel=function(){t.go("productList")},u.addTags=function(t){if(t){var e=t.split(",");u.product.tags=u.product.tags?u.product.tags.concat(e):e,u.newTags=""}else alert("Please enter one or more tags separated by commas")},u.removeTag=function(t){u.product.tags.splice(t,1)},u.uploader=new o;var s=u.uploader=new o({url:"/api/imageupload"});s.filters.push({name:"imageFilter",fn:function(t,e){var r="|"+t.type.slice(t.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(r)}}),s.onSuccessItem=function(t,e,r,n){i=e.substring(e.indexOf("images"),e.length)},console.info("uploader",s)}angular.module("app").controller("ProductEditCtrl",["$state","productService","httprequest","$stateParams","FileUploader",t])}(),function(){"use strict";function t(t,e,r,n){t.title="Price Analytics";for(var o=0;o<r.length;o++)r[o].marginPercent=n.calculateMarginPercent(r[o].price,r[o].cost),r[o].marginAmount=n.calculateMarginAmount(r[o].price,r[o].cost);for(var u=e("orderBy")(r,"marginAmount"),i=e("limitTo")(u,5),a=[],o=0;o<i.length;o++)a.push({x:i[o].productName,y:[i[o].cost,i[o].price,i[o].marginAmount]});t.dataAmount={series:["Cost","Price","Margin Amount"],data:a},t.configAmount={title:"Top $ Margin Products",tooltips:!0,labels:!1,mouseover:function(){},mouseout:function(){},click:function(){},legend:{display:!0,position:"right"}};for(var c=e("orderBy")(r,"marginPercent"),s=e("limitTo")(c,5),l=[],o=0;o<s.length;o++)l.push({x:s[o].productName,y:[s[o].marginPercent]});t.dataPercent={series:["Margin %"],data:l},t.configPercent={title:"Top % Margin Products",tooltips:!0,labels:!1,mouseover:function(){},mouseout:function(){},click:function(){},legend:{display:!0,position:"right"}}}angular.module("app").controller("PriceAnalyticsCtrl",["$scope","$filter","products","productService",t])}(),function(){"use strict";angular.module("common.services",["ngResource"])}(),function(){"use strict";function t(t,e,r){var n=this,o=function(){t.http_get("/api/products").then(function(t){n.products=t})};o(),n.showImage=!1,n.toggleImage=function(){n.showImage=!n.showImage},n.delete=function(e){var r=n.products[e];t.http_delete("/api/product/"+r._id).then(function(t){n.products.splice(e,1),toastr.error("Product Deleted")})},e.cancel=function(){r.dismiss("cancel")},e.open=function(t){var e=r.open({templateUrl:"app/admin/products/deleteModal.html",controller:function(t,e){t.confirmDelete=function(t){e.close(t)}}});e.result.then(function(e){e&&n.delete(t)})}}angular.module("app").controller("ProductListCtrl",["httprequest","$scope","$modal",t])}(),function(){"use strict";function t(t){return t("/api/products/:productId")}angular.module("common.services").factory("productResource",["$resource",t])}(),function(){"use strict";function t(){function t(t,e){var r=0;return t&&e&&(r=100*(t-e)/t),r=Math.round(r)}function e(t,e){var r=0;return t&&e&&(r=t-e),r}function r(t,e){var r=t;return t&&e&&(r=t+t*e/100,r=Math.round(100*r)/100),r}function n(t,e){var r=t;return t&&e&&(r=t+e,r=Math.round(100*r)/100),r}return{calculateMarginPercent:t,calculateMarginAmount:e,calculatePriceFromMarkupPercent:r,calculatePriceFromMarkupAmount:n}}angular.module("app").factory("productService",t)}(),function(){"use strict";angular.module("app").controller("mvSchoolInfo",["$scope",function(t){t.map={center:{latitude:42.359482,longitude:-71.1557882},zoom:8}}])}(),angular.module("app").controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close()},t.cancel=function(){e.dismiss("cancel")}}]),angular.module("app").controller("mvProfileCtrl",["$scope","mvAuth","mvIdentity","mvNotifier",function(t,e,r,n){t.email=r.currentUser.username,t.fname=r.currentUser.firstName,t.lname=r.currentUser.lastName,t.update=function(){var r={username:t.email,firstName:t.fname,lastName:t.lname};t.password&&t.password.length>0&&(r.password=t.password),e.updateCurrentUser(r).then(function(){n.notify("Your user account has been updated")},function(t){n.error(t)})}}]);
//# sourceMappingURL=./scripts-min.js.map